<!doctype html>
<html lang="en" data-theme="light">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>‚Ä¢ LingoFlow ‚Ä¢</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="resources/css/styles.css" />
</head>

<body>
    <header>
        <div class="logo">‚Ä¢ LingoFlow ‚Ä¢</div>
        <div class="credits">
            by <a href="https://github.com/Nikolichnik" target="_blank">Nikola Stojanoviƒá</a>, inspired by <a
                href="https://www.youtube.com/@NaturalLanguageLearning" target="_blank">Mikel | Hyperpolyglot</a>
        </div>
        <div class="row" style="justify-content:flex-end; gap:10px;">
            <button id="themeToggleBtn" class="pill" aria-pressed="true" title="Toggle light/dark">‚òÄÔ∏è Light</button>
            <button id="helpBtn" class="pill">üõü Help</button>
        </div>
    </header>

    <!-- Controls row: 3 panels -->
    <section class="row cards-row sticky-tools">
        <!-- 1) Load / Export -->
        <div class="card grow" id="importCard" style="flex-grow: 0.5;">
            <div class="card-header">Load / Export</div>

            <div class="control-row">
                <label class="file-picker pill" for="fileInput">
                    <input id="fileInput" type="file" accept=".csv" />
                    <span class="file-picker-button">Choose file</span>
                    <span class="file-picker-summary placeholder" id="deckInfo">Load a CSV deck to get started</span>
                </label>
            </div>

            <div class="button-row">
                <button id="exportBtn" class="pill primary" disabled>Export deck</button>
            </div>
        </div>

        <!-- 2) Playback -->
        <div class="card grow" id="playbackCard">
            <div class="card-header">Playback</div>

            <div class="control-row">
                <label class="pill nowrap" style="max-width: 200px; overflow: hidden;">
                    <span class="muted">Voice</span>
                    <select id="voiceSel"></select>
                </label>

                <div class="pill slider nowrap">
                    <span>Speed</span>
                    <input type="range" id="rate" min="0.1" max="2" step="0.1" value="0.5" />
                    <span id="rateVal">0.5√ó</span>
                </div>

                <div class="pill slider nowrap">
                    <span>Volume</span>
                    <input type="range" id="vol" min="0" max="1" step="0.01" value="1" />
                    <span id="volVal">100%</span>
                </div>
            </div>

            <div class="row">
                <div class="control-row">
                    <label class="pill"><input type="checkbox" id="loopChk" />Loop</label>
                    <label class="pill"><input type="checkbox" id="shuffleChk" />Shuffle</label>
                    <label class="pill"><input type="checkbox" id="speakWordsChk" checked />Words</label>
                    <label class="pill"><input type="checkbox" id="speakExamplesChk" checked />Examples</label>
                    <label class="pill"><input type="checkbox" id="speakTranslationsChk" />Include translations</label>
                </div>

                <div class="button-row" style="margin-left:auto;">
                    <button id="playBtn" class="pill primary">‚ñ∂ Auto-play</button>
                    <button id="stopBtn" class="pill ghost" disabled>Stop</button>
                </div>
            </div>
        </div>

        <!-- 3) Filters -->
        <div class="card grow" id="filterCard" style="flex-grow: 0.5;">
            <div class="card-header">Filters</div>

            <div class="control-row">
                <label class="pill nowrap" style="width:100%;">
                    <span class="muted">Familiarity</span>
                    <div class="double-slider">
                        <span class="badge" id="minFamVal">0</span>
                        <div class="range-wrap">
                            <div class="range-track"></div>
                            <div class="range-fill"></div>
                            <input type="range" id="minFamSel" min="0" max="5" step="1" value="0"
                                aria-label="Minimum familiarity" />
                            <input type="range" id="maxFamSel" min="0" max="5" step="1" value="5"
                                aria-label="Maximum familiarity" />
                        </div>
                        <span class="badge" id="maxFamVal">5</span>
                    </div>
                </label>
            </div>

            <div class="button-row">
                <button id="applyFilterBtn" class="pill primary">Apply</button>
            </div>
        </div>
    </section>

    <div class="table-container">
        <!-- Table -->
        <table id="deckTbl" class="hidden" aria-live="polite">
            <thead>
                <tr>
                    <th id="col-ordinal">
                        <button type="button" class="sort-btn" data-sort="ordinal" aria-label="Sort by number">#</button>
                    </th>
                    <th>Word</th>
                    <th>Example</th>
                    <th>Translation</th>
                    <th>Example Translation</th>
                    <th id="col-familiarity">
                        <button type="button" class="sort-btn" data-sort="familiarity">Familiarity</button>
                    </th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <div id="help-modal" class="bf-help-modal" aria-hidden="true" role="dialog" aria-modal="true">
        <div class="bf-help-backdrop" data-help-close></div>
        <div class="bf-help-panel" role="document" aria-labelledby="help-title">
            <button class="bf-help-close" type="button" title="Close (Esc)" data-help-close>√ó</button>
            <div id="help-content" class="bf-help-content"></div>
        </div>
    </div>

    <template id="help-template">
        <article>
            <h1 id="help-title">LingoFlow ‚Ä¢ Help</h1>
            <p>A lightweight <strong>CSV ‚Üí audio player</strong> for vocabulary study inspired by <a
                    style="color: var(--accent)"
                    href="https://www.youtube.com/@NaturalLanguageLearning" target="_blank">Mikel | Hyperpolyglot's YouTube
                    channel</a>.</p>
            <p>Load a deck, click any <em>Word</em> or <em>Example</em> to hear it, or use <em>Auto-play</em> for hands-free
                listening. Track progress with <em>Familiarity</em> ‚òÖ ratings and export your updated CSV anytime. Use it for
                the most frequent <strong>verbs, nouns, phrases, or any mix</strong> you want to learn.</p>

            <h2>Quick start</h2>
            <ol>
                <li><strong>Load a CSV</strong> (Load/Export panel ‚Üí <em>Choose file</em>).<br>
                    - Required columns: <code>word</code>, <code>example</code>.<br>
                    - Optional: <code>translation</code>, <code>example_translation</code>, <code>familiarity</code>
                    (0-5).<br>
                    - <strong>Example CSVs</strong> are available in the <code>/decks</code> folder.
                </li>
                <li><strong>Playback</strong>: pick a <em>Voice</em>, adjust <em>Speed</em> and <em>Volume</em>, then
                    toggle: <em>Loop</em>, <em>Shuffle</em>, <em>Words</em>, <em>Examples</em>, <em>Include translations</em>.
                    Click <strong>Auto-play</strong>.</li>
                <li><strong>Study</strong>: click any <span style="color: var(--accent)">highlighted</span> <em>Word</em> or
                    <em>Example</em> to hear it once; set ‚òÖ in the <em>Familiarity</em> column (0-5).</li>
                <li><strong>Filter</strong>: use the <em>Familiarity</em> range slider, then <strong>Apply</strong> to focus on
                    a band (e.g., 0-2).</li>
                <li><strong>Export</strong>: <em>Export CSV</em> saves a copy with your current familiarity ratings
                    (everything runs locally).</li>
            </ol>

            <h2>CSV format</h2>
            <pre><code>word|example|translation|example_translation|familiarity
sein|Ich bin m√ºde.|to be|I am tired.|2
haben|Wir haben Zeit.|to have|We have time.|1
gehen|Er geht nach Hause.|to go|He goes home.|0</code></pre>
            <p><em>Note:</em> In order to support rich examples, the CSV uses <code>|</code> (pipe) as the column separator
                instead of the more common comma. Column names are case-insensitive; extra columns are ignored.</p>

            <h2>Suggested study flow</h2>
            <ol>
                <li><strong>Passive listening (background)</strong>: turn on <em>Auto-play</em> (optionally <em>Shuffle</em> +
                    <em>Loop</em>) while commuting, walking, or doing chores.</li>
                <li><strong>Active blocks</strong>:
                    <ul>
                        <li><strong>Round A - Listen while reading:</strong> follow each sentence as it's spoken; keep
                            <em>Include translations</em> on so meaning is clear.</li>
                        <li><strong>Round B - Active recall:</strong> look at the <em>translation</em>, say the <em>target</em>
                            sentence out loud from memory, then check. Expect mistakes - they're part of learning.</li>
                    </ul>
                    Alternate A ‚Üí B ‚Üí A across batches of 100-300 rows (or any size you like).
                </li>
                <li><strong>Bridge to native content:</strong> once deck items feel easy, alternate 5-20 minutes of your deck
                    with 5-20 minutes of real podcasts/videos you enjoy. If it's overwhelming, jump back to the deck; repeat.
                    As you improve, raise <em>Speed</em> (e.g., 1.25√ó ‚Üí 1.5√ó) so authentic content feels easier.</li>
                <li><strong>Mnemonics (optional):</strong> for hard items, invent quick sound-alike images/stories to link
                    <em>sound ‚Üî meaning</em>.</li>
            </ol>

            <h2>7-day sprint (example)</h2>
            <ul>
                <li><strong>Daily passive:</strong> 60-120 min of Auto-play in the background.</li>
                <li><strong>Daily focused:</strong> 2-3 √ó 25-min Pomodoros (Round A / Round B).</li>
            </ul>
            <table>
                <thead>
                    <tr>
                        <th align="left">Day</th>
                        <th align="left">Focus</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td>Round A on rows 1-300 (listen while reading, translations on).</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>Round B on rows 1-300 (active recall).</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>Round A on rows 300-600.</td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td>Round B on rows 300-600.</td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td>Filter 0-2 and clean up weak items; update ‚òÖ ratings.</td>
                    </tr>
                    <tr>
                        <td>6</td>
                        <td>Alternate deck ‚Üî native audio (several cycles).</td>
                    </tr>
                    <tr>
                        <td>7</td>
                        <td>Increase Speed; continue alternating; Export CSV to save progress.</td>
                    </tr>
                </tbody>
            </table>

            <h2>Tips</h2>
            <ul>
                <li><strong>Pick a matching voice</strong> (e.g., de-DE, fr-FR, es-MX) for the best TTS.</li>
                <li><strong>Shuffle</strong> prevents memorising fixed order; <strong>Filter</strong> to focus on weak items
                    (0-2).</li>
                <li><strong>Speak out loud</strong> during recall - production solidifies memory.</li>
                <li><strong>Short, frequent reps</strong> beat marathon sessions; export regularly to back up your ‚òÖ
                    progress.</li>
            </ul>

            <h2>Troubleshooting</h2>
            <ul>
                <li><strong>No speech / missing voices?</strong> Use a modern browser (Chrome/Edge/Safari) with Speech
                    Synthesis. Voices come from your OS and may take a moment to appear.</li>
                <li><strong>CSV won't load?</strong> Ensure headers include <code>word</code> and <code>example</code>.
                    Optional fields are supported but not required.</li>
                <li><strong>Privacy:</strong> Everything runs locally in your browser. Familiarity updates are written only when
                    you <em>Export deck</em>.</li>
            </ul>

            <p><strong>You've got this.</strong> Listen a lot, recall actively, and bridge to native content - tailor decks to
                verbs, nouns, phrases, or any mix that fits your goals.</p>
        </article>
    </template>

    <script src="resources/js/csv.js"></script>
    <script src="resources/js/deck-store.js"></script>
    <script src="resources/js/speech.js"></script>
    <script src="resources/js/ui.js"></script>
    <script src="resources/js/app.js"></script>
</body>

</html>
